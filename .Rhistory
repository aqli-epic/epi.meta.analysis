geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
} else{
for(i in 1:length(missing_continents)){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
add_row(continent = missing_continents[i])
}
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
}
#> calculations relevant for this block of code
# long term study threshold
long_term_study_duration <- 25
# number of "really long term studies"
num_really_long_term_studies <- epi %>%
group_by(paper_uid) %>%
summarise(mean_duration = mean(study_duration, na.rm = TRUE)) %>%
filter(mean_duration > long_term_study_duration) %>%
nrow()
# continents that have seen studies greater than x (long_term) years of study duration
epi_long_term_studies_countries <- epi %>%
group_by(paper_uid, continent) %>%
summarise(mean_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
filter(mean_study_duration > long_term_study_duration, mean_study_duration != "NA", !is.na(mean_study_duration)) %>%
select(continent) %>%
count(continent) %>%
mutate(prop_n = round((n/sum(n, na.rm = TRUE))*100, 1)) %>%
slice_max(prop_n, n = 6)
# continent order list (order variable: number of studies): code present in the geographical distribution map block.
# plot continent wise study duration graph
continent_wise_study_duration_graph
continent_wise_study_duration_graph
missing_continents
unique(epi$continent)
#>  In this, in the graph multiple countries of a pooled study are counted separately. Also, this is not a PM2.5 specific graph.
#> Density plot of study duration (commented for now, can use later if required)
# epi %>%
#   filter(!is.na(study_duration)) %>%
#   ggplot() +
#   geom_density(mapping = aes(x = study_duration, fill = continent), alpha = 0.5) +
#     labs(x = "Study Duration") +
#   ggtitle("Epi Studies Duration Distribution (Continent Wise): Density Plot") +
#   scale_x_continuous(breaks = seq(0, 40, 5)) +
#   theme_tufte() +
#   theme(legend.position = "bottom")
#> Histogram of study duration
#> adding an order panel and also dummy panels (for those cases in which we are looking at a subset of a dataset that does not include certain continents).
# missing continents
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
missing_continents_logical <- continent_list %notin% unique(epi$continent)
missing_continents <- continent_list[missing_continents_logical]
if(sum(missing_continets_logical) == 0){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
} else{
for(i in 1:length(missing_continents)){
if(i == 1){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
add_row(continent = missing_continents[i])
} else{
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
add_row(continent = missing_continents[i])
}
}
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
}
#>  In this, in the graph multiple countries of a pooled study are counted separately. Also, this is not a PM2.5 specific graph.
#> Density plot of study duration (commented for now, can use later if required)
# epi %>%
#   filter(!is.na(study_duration)) %>%
#   ggplot() +
#   geom_density(mapping = aes(x = study_duration, fill = continent), alpha = 0.5) +
#     labs(x = "Study Duration") +
#   ggtitle("Epi Studies Duration Distribution (Continent Wise): Density Plot") +
#   scale_x_continuous(breaks = seq(0, 40, 5)) +
#   theme_tufte() +
#   theme(legend.position = "bottom")
#> Histogram of study duration
#> adding an order panel and also dummy panels (for those cases in which we are looking at a subset of a dataset that does not include certain continents).
# missing continents
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
missing_continents_logical <- continent_list %notin% unique(epi$continent)
missing_continents <- continent_list[missing_continents_logical]
if(sum(missing_continets_logical) == 0){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
} else{
for(i in 1:length(missing_continents)){
if(i == 1){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
add_row(continent = missing_continents[i])
} else{
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
add_row(continent = missing_continents[i])
}
}
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
}
#> calculations relevant for this block of code
# long term study threshold
long_term_study_duration <- 25
# number of "really long term studies"
num_really_long_term_studies <- epi %>%
group_by(paper_uid) %>%
summarise(mean_duration = mean(study_duration, na.rm = TRUE)) %>%
filter(mean_duration > long_term_study_duration) %>%
nrow()
# continents that have seen studies greater than x (long_term) years of study duration
epi_long_term_studies_countries <- epi %>%
group_by(paper_uid, continent) %>%
summarise(mean_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
filter(mean_study_duration > long_term_study_duration, mean_study_duration != "NA", !is.na(mean_study_duration)) %>%
select(continent) %>%
count(continent) %>%
mutate(prop_n = round((n/sum(n, na.rm = TRUE))*100, 1)) %>%
slice_max(prop_n, n = 6)
# continent order list (order variable: number of studies): code present in the geographical distribution map block.
# plot continent wise study duration graph
continent_wise_study_duration_graph
continent_wise_study_duration_graph
continent_wise_study_summary
#> setting report parameters
min_sample_size <- 1000
min_study_duration_in_years <- 1
Sys.Date()
Sys.Date()
str_extract(Sys.Date(), "....")
as.numeric("2022")
#> read in datasets
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
# AQLI color file
aqli_color <- read_csv("./data-raw/pm2.5_distribution/color.csv")
# global operations
`%notin%` <- Negate(`%in%`)
# global variables
who_pm2.5_guideline <- 5
# continent list
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
# missing continents
missing_continents_logical <- continent_list %notin% unique(epi$continent)
missing_continents <- continent_list[missing_continents_logical]
#> change default columns types
epi$cohort_size <- as.numeric(epi$cohort_size)
epi$study_start_year<- as.numeric(epi$study_start_year)
epi$study_end_year <- as.numeric(epi$study_end_year)
epi$pm2.5_exposure_ll <- as.numeric(epi$pm2.5_exposure_ll)
epi$pm2.5_exposure_ul <- as.numeric(epi$pm2.5_exposure_ul)
epi$mean_pm2.5 <- as.numeric(epi$mean_pm2.5)
epi$sd_pm2.5 <- as.numeric(epi$sd_pm2.5)
epi$cohort_age_ll <- as.numeric(epi$cohort_age_ll)
epi$cohort_age_ul <- as.numeric(epi$cohort_age_ul)
#> add useful columns and filter out some studies (e.g. pooled studies, meta analysis, other parameter based filtering)
epi <- epi %>%
mutate(study_duration = study_end_year - study_start_year)
#> setting report parameters
min_sample_size <- 1000
min_study_duration_in_years <- 1
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
#> Calculations needed for all sections above the "Results section".
# percent of population not in compliance with the WHO guideline
num_people_above_who <- aqli_color %>%
filter(pm2020 > who_pm2.5_guideline) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
# world population
world_pop <- aqli_color %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
percent_people_above_who <- round((num_people_above_who/world_pop)*100, 1)
#>  In this, in the graph multiple countries of a pooled study are counted separately. Also, this is not a PM2.5 specific graph.
#> Density plot of study duration (commented for now, can use later if required)
# epi %>%
#   filter(!is.na(study_duration)) %>%
#   ggplot() +
#   geom_density(mapping = aes(x = study_duration, fill = continent), alpha = 0.5) +
#     labs(x = "Study Duration") +
#   ggtitle("Epi Studies Duration Distribution (Continent Wise): Density Plot") +
#   scale_x_continuous(breaks = seq(0, 40, 5)) +
#   theme_tufte() +
#   theme(legend.position = "bottom")
#> Histogram of study duration
#> adding an order panel and also dummy panels (for those cases in which we are looking at a subset of a dataset that does not include certain continents).
if(sum(missing_continents_logical) == 0){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
} else{
for(i in 1:length(missing_continents)){
if(i == 1){
continent_wise_study_duration_graph <- epi %>%
dplyr::filter(continent != "NA", !is.na(continent), study_duration != "NA", !is.na(study_duration)) %>%
group_by(paper_uid, continent) %>%
summarise(average_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
add_row(continent = missing_continents[i])
} else{
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
add_row(continent = missing_continents[i])
}
}
continent_wise_study_duration_graph <- continent_wise_study_duration_graph %>%
mutate(order_continent = ifelse(continent == "Asia", 1, 0),
order_continent = ifelse(continent == "Europe", 2, order_continent),
order_continent = ifelse(continent == "North America", 3, order_continent),
order_continent = ifelse(continent == "South America", 4, order_continent),
order_continent = ifelse(continent == "Africa", 5, order_continent),
order_continent = ifelse(continent == "Oceania", 6, order_continent)) %>%
ggplot() +
geom_histogram(mapping = aes(x = average_study_duration, fill = continent), alpha = 0.5, color = "white", position = "identity", binwidth = 2) +
labs(x = "Study Duration") +
ggtitle("Epi Studies Duration Distribution (Continent Wise): Histogram") +
scale_x_continuous(breaks = seq(0, 40, 10)) +
theme_hc() +
theme(legend.title = element_blank()) +
facet_wrap(~fct_reorder(continent, order_continent), nrow = 1) +
theme(axis.line.y = element_line(color = "black"),
axis.line.x = element_line(color = "black"))
}
#> calculations relevant for this block of code
# long term study threshold
long_term_study_duration <- 25
# number of "really long term studies"
num_really_long_term_studies <- epi %>%
group_by(paper_uid) %>%
summarise(mean_duration = mean(study_duration, na.rm = TRUE)) %>%
filter(mean_duration > long_term_study_duration) %>%
nrow()
# continents that have seen studies greater than x (long_term) years of study duration
epi_long_term_studies_countries <- epi %>%
group_by(paper_uid, continent) %>%
summarise(mean_study_duration = mean(study_duration, na.rm = TRUE)) %>%
ungroup() %>%
filter(mean_study_duration > long_term_study_duration, mean_study_duration != "NA", !is.na(mean_study_duration)) %>%
select(continent) %>%
count(continent) %>%
mutate(prop_n = round((n/sum(n, na.rm = TRUE))*100, 1)) %>%
slice_max(prop_n, n = 6)
# continent order list (order variable: number of studies): code present in the geographical distribution map block.
# plot continent wise study duration graph
continent_wise_study_duration_graph
epicontinent_wise_study_duration_graph
continent_wise_study_duration_graph
#> read in datasets
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
# AQLI color file
aqli_color <- read_csv("./data-raw/pm2.5_distribution/color.csv")
# global operations
`%notin%` <- Negate(`%in%`)
# global variables
who_pm2.5_guideline <- 5
#> setting report parameters
min_sample_size <- 1000
min_study_duration_in_years <- 1
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
# continent list
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
# missing continents
missing_continents_logical <- continent_list %notin% unique(epi$continent)
missing_continents <- continent_list[missing_continents_logical]
#> change default columns types
epi$cohort_size <- as.numeric(epi$cohort_size)
epi$study_start_year<- as.numeric(epi$study_start_year)
epi$study_end_year <- as.numeric(epi$study_end_year)
epi$pm2.5_exposure_ll <- as.numeric(epi$pm2.5_exposure_ll)
epi$pm2.5_exposure_ul <- as.numeric(epi$pm2.5_exposure_ul)
epi$mean_pm2.5 <- as.numeric(epi$mean_pm2.5)
epi$sd_pm2.5 <- as.numeric(epi$sd_pm2.5)
epi$cohort_age_ll <- as.numeric(epi$cohort_age_ll)
epi$cohort_age_ul <- as.numeric(epi$cohort_age_ul)
#> add useful columns and filter out some studies (e.g. pooled studies, meta analysis, other parameter based filtering)
epi <- epi %>%
mutate(study_duration = study_end_year - study_start_year)
#> Calculations needed for all sections above the "Results section".
# percent of population not in compliance with the WHO guideline
num_people_above_who <- aqli_color %>%
filter(pm2020 > who_pm2.5_guideline) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
# world population
world_pop <- aqli_color %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
percent_people_above_who <- round((num_people_above_who/world_pop)*100, 1)
missing_continents
nrow(epi)
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
# AQLI color file
aqli_color <- read_csv("./data-raw/pm2.5_distribution/color.csv")
# global operations
`%notin%` <- Negate(`%in%`)
# global variables
who_pm2.5_guideline <- 5
#> setting report parameters
min_sample_size <- 1000
min_study_duration_in_years <- 1
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
unique(epi$continent)
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
nrow(epi)
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
nrow(epi)
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
nrow(epi)
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
# continent list
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
unique(epi$continent)
rm(list = ls())
#> read in datasets
# epi studies analysis raw sheet
epi <- readxl::read_xlsx("./data-raw/pm2.5_distribution/AQLI_Epidemiology Literature Research.xlsx", sheet = "AnalysisDatasetPM2.5MortalityAn")
# AQLI color file
aqli_color <- read_csv("./data-raw/pm2.5_distribution/color.csv")
# global operations
`%notin%` <- Negate(`%in%`)
# global variables
who_pm2.5_guideline <- 5
#> setting report parameters
min_sample_size <- 1000
min_study_duration_in_years <- 1
#> Filtering the epi database (minimum cohort size: >1000, minimum study duration: > 1 year): commented for now.
epi <- epi %>%
mutate(study_duration = (study_end_year - study_start_year) + 1) %>%
filter(cohort_size > min_sample_size, study_duration > min_study_duration_in_years)
# continent list
continent_list <- c("Asia", "Africa", "North America", "South America", "Europe", "Oceania")
# missing continents
missing_continents_logical <- continent_list %notin% unique(epi$continent)
missing_continents <- continent_list[missing_continents_logical]
#> change default columns types
epi$cohort_size <- as.numeric(epi$cohort_size)
epi$study_start_year<- as.numeric(epi$study_start_year)
epi$study_end_year <- as.numeric(epi$study_end_year)
epi$pm2.5_exposure_ll <- as.numeric(epi$pm2.5_exposure_ll)
epi$pm2.5_exposure_ul <- as.numeric(epi$pm2.5_exposure_ul)
epi$mean_pm2.5 <- as.numeric(epi$mean_pm2.5)
epi$sd_pm2.5 <- as.numeric(epi$sd_pm2.5)
epi$cohort_age_ll <- as.numeric(epi$cohort_age_ll)
epi$cohort_age_ul <- as.numeric(epi$cohort_age_ul)
#> Calculations needed for all sections above the "Results section".
# percent of population not in compliance with the WHO guideline
num_people_above_who <- aqli_color %>%
filter(pm2020 > who_pm2.5_guideline) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
# world population
world_pop <- aqli_color %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
unlist()
percent_people_above_who <- round((num_people_above_who/world_pop)*100, 1)
missing_continents
epi %>%
group_by(paper_uid, continent) %>%
summarise(mean_study_duration = mean(study_duration, na.rm = TRUE))
missing_continents
# getting a country continent file
country_continent <- read_csv("./data-raw/pm2.5_distribution/country_continent.csv")
country_continent
runApp()
rm(list = ls())
runApp()
# loading the .RData file that contain all required data objects
save(list = ls(all = TRUE), file= "all.RData")
runApp()
