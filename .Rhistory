#   geom_col(mapping = aes(x = country, y = count_studies, group = continent, fill = continent), position = position_dodge2(preserve = "single"))
# # #> population pollution figure (new version)-------------------------------
# #
# # adding pollution buckets
# aqli_color_with_pol_buckets <- aqli_color %>%
#   mutate(pol_buckets = ifelse(((pm2021 >= 0) & (pm2021 <= 5)), "0 - 5", NA),
#          pol_buckets = ifelse(((pm2021 > 5) & (pm2021 <= 10)), ">5 - 10", pol_buckets),
#          pol_buckets = ifelse(((pm2021 > 10) & (pm2021 <= 20)), ">10 - 20", pol_buckets),
#          pol_buckets = ifelse(((pm2021 > 20) & (pm2021 <= 40)), ">20 - 40", pol_buckets),
#          pol_buckets = ifelse(((pm2021 > 40) & (pm2021 <= 80)), ">40 - 80", pol_buckets),
#          pol_buckets = ifelse(((pm2021 > 80)), ">80", pol_buckets)) %>%
#   mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
#          pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order))
#
# # converting the 2 newly created columns to type factor
# aqli_color_with_pol_buckets$pol_buckets <- as.factor(aqli_color_with_pol_buckets$pol_buckets)
# aqli_color_with_pol_buckets$pol_bucket_order <- as.factor(aqli_color_with_pol_buckets$pol_bucket_order)
#
#
# aqli_color_with_pol_buckets %>%
#   group_by(pol_buckets) %>%
#   summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
#   ungroup() %>%
#   mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
#          pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
#          pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
#   filter(!is.na(pol_buckets)) %>%
#   mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
#   ggplot() +
#   geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
#   ggthemes::theme_hc() +
#   labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
#        title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
#   theme(plot.title = element_text(hjust = 0.5, size = 12),
#         axis.title.x = element_text(size = 9),
#         axis.title.y = element_text(size = 9),
#         legend.title = element_text(size = 8),
#         legend.background = element_rect(color = "black")) +
#   viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi
epi_with_pol_buckets <- epi %>%
mutate(pol_buckets = ifelse(((mean_pm2.5 >= 0) & (mean_pm2.5 <= 5)), "0 - 5", NA),
pol_buckets = ifelse(((mean_pm2.5 > 5) & (mean_pm2.5 <= 10)), ">5 - 10", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 10) & (mean_pm2.5 <= 20)), ">10 - 20", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 20) & (mean_pm2.5 <= 40)), ">20 - 40", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 40) & (mean_pm2.5 <= 80)), ">40 - 80", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 80)), ">80", pol_buckets)) %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order))
epi_with_pol_buckets$pol_buckets <- as.factor(epi_with_pol_buckets$pol_buckets)
epi_with_pol_buckets$pol_bucket_order <- as.factor(epi_with_pol_buckets$pol_bucket_order)
# doing a similar thing with the epi dataset to get the total number of studies in different pollution buckets.
epi_with_pol_buckets <- epi %>%
mutate(pol_buckets = ifelse(((mean_pm2.5 >= 0) & (mean_pm2.5 <= 5)), "0 - 5", NA),
pol_buckets = ifelse(((mean_pm2.5 > 5) & (mean_pm2.5 <= 10)), ">5 - 10", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 10) & (mean_pm2.5 <= 20)), ">10 - 20", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 20) & (mean_pm2.5 <= 40)), ">20 - 40", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 40) & (mean_pm2.5 <= 80)), ">40 - 80", pol_buckets),
pol_buckets = ifelse(((mean_pm2.5 > 80)), ">80", pol_buckets)) %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) +
scale_y_continuous(breaks = seq(0, 3000, 500))
aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE))
epi_with_pol_buckets$pol_buckets
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "Global Population spread across different pollution buckets", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE)
epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
theme(legend.position = "none")
foo <- epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
theme(legend.position = "none")
foo1 <- epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
theme(legend.position = "none")
foo < -aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
foo <- aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
gridExtra::grid.arrange(foo, foo1)
gridExtra::grid.arrange(foo1, fo1)
gridExtra::grid.arrange(foo1, foo1)
gridExtra::grid.arrange(foo1, foo)
foo1 <- epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.5) +
ggthemes::theme_hc() +
labs(x =  ""), y = "Total number of epi studies",
foo <- aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.2) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
foo1 <- epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.2) +
ggthemes::theme_hc() +
labs(x =  "", y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
theme(legend.position = "none")
?geom_col
foo <- aqli_color_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(tot_pop = sum(population, na.rm = TRUE)) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
mutate(tot_pop_millions = round(tot_pop/1000000, 1)) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = tot_pop_millions, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.2) +
ggthemes::theme_hc() +
labs(x =  expression("Annual Average" ~ PM[2.5] ~ ("in µg/m³")), y = "Total Population (in millions)",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
scale_y_continuous(breaks = seq(0, 3000, 500))
foo1 <- epi_with_pol_buckets %>%
group_by(pol_buckets) %>%
summarise(total_studies = n()) %>%
ungroup() %>%
mutate(pol_bucket_order = ifelse(pol_buckets == "0 - 5", 1, NA),
pol_bucket_order = ifelse(pol_buckets == ">5 - 10", 2, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">10 - 20", 3, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">20 - 40", 4, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">40 - 80", 5, pol_bucket_order),
pol_bucket_order = ifelse(pol_buckets == ">80", 6, pol_bucket_order)) %>%
filter(!is.na(pol_buckets)) %>%
add_row(pol_bucket_order = 1, pol_buckets = "0 - 5", total_studies = 0) %>%
add_row(pol_bucket_order = 6, pol_buckets = ">80", total_studies = 0) %>%
ggplot() +
geom_col(mapping = aes(x = forcats::fct_reorder(pol_buckets, pol_bucket_order), y = total_studies, fill = forcats::fct_reorder(pol_buckets, pol_bucket_order)), width = 0.2) +
ggthemes::theme_hc() +
labs(x =  "", y = "Total number of epi studies",
title = "", fill = expression("Annual Average" ~ PM[2.5] ~ "(in µg/m³)")) +
theme(plot.title = element_text(hjust = 0.5, size = 12),
axis.title.x = element_text(size = 9),
axis.title.y = element_text(size = 9),
legend.title = element_text(size = 8),
legend.background = element_rect(color = "black")) +
viridis::scale_fill_viridis(option = "magma", direction = -1, discrete = TRUE) +
theme(legend.position = "none")
gridExtra::grid.arrange(foo1, foo)
